2022-09-01 03:46:11,323 - root - INFO - 



.\main.py -c .\configs\main\none\one_label\config.ini -m train -g 0 -bs 1 -dt
2022-09-01 03:46:11,324 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 03:46:12,144 - utils - INFO - CUDA is available.
2022-09-01 03:46:12,144 - utils - INFO - Initialize GPUs successfully.
2022-09-01 03:46:12,144 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 03:46:12,145 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 03:46:12,145 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 03:46:17,899 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 03:46:18,086 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 03:46:18,088 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 03:46:18,088 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2022-09-01 03:46:18,089 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2022-09-01 03:46:18,090 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2022-09-01 03:46:18,090 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2022-09-01 03:46:18,090 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2022-09-01 03:46:18,130 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 03:46:18,178 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 03:46:18,179 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2022-09-01 03:46:18,180 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2022-09-01 03:46:18,181 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 03:46:18,203 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 03:46:18,203 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2022-09-01 03:46:18,203 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 03:46:18,204 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 03:46:18,223 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 03:46:18,224 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 03:46:18,224 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 03:46:18,224 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 03:46:18,225 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 03:46:18,225 - legal_judgment_prediction.train - INFO - Start to train model.
2022-09-01 03:46:20,636 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   0   | train |    1/20    | 0:02/ 0:45 | 200.4022979736328 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.478 | 0.478 | 0.478 |
| article_source | 0.0 | 0.0 | 0.0 | 0.286 | 0.286 | 0.286 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.466 | 0.466 | 0.466 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:46:35,517 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   0   | train |   20/20    | 0:17/ 0:00 | 127.72864723205566 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     | 0.011 | 0.2  | 0.021 | 0.143 | 0.149 | 0.14  |
| article_source | 0.171 | 0.95 | 0.29  | 0.19  | 0.236 | 0.193 |
|   accusation   | 0.012 | 0.35 | 0.023 | 0.141 | 0.153 | 0.142 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 03:46:49,427 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |    1/10    | 0:00/ 0:02 | 74.54051208496094 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-------+-------+-------+-------+
|      Type      | MiP | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-------+-------+-------+-------+
|    article     | 0.0 | 0.0 |  0.0  | 0.989 | 0.989 | 0.989 |
| article_source | 0.5 | 1.0 | 0.667 | 0.952 | 0.952 | 0.952 |
|   accusation   | 0.0 | 0.0 |  0.0  | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-------+-------+-------+-------+

2022-09-01 03:46:52,499 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |   10/10    | 0:03/ 0:00 | 72.77504959106446 |
+-------+-------+------------+------------+-------------------+
+----------------+-------+-----+-------+-------+-------+-------+
|      Type      |  MiP  | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-----+-------+-------+-------+-------+
|    article     |  0.0  | 0.0 |  0.0  | 0.933 | 0.933 | 0.933 |
| article_source | 0.476 | 1.0 | 0.645 | 0.905 | 0.952 | 0.911 |
|   accusation   | 0.158 | 0.3 | 0.207 | 0.941 | 0.946 | 0.942 |
+----------------+-------+-----+-------+-------+-------+-------+

2022-09-01 03:46:52,942 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | test  |    1/10    | 0:00/ 0:03 | 73.05085754394531 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-------+-------+-------+-------+
|      Type      | MiP | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-------+-------+-------+-------+
|    article     | 0.0 | 0.0 |  0.0  | 0.989 | 0.989 | 0.989 |
| article_source | 0.5 | 1.0 | 0.667 | 0.952 | 0.952 | 0.952 |
|   accusation   | 0.0 | 0.0 |  0.0  | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-------+-------+-------+-------+

2022-09-01 03:46:56,089 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | test  |   10/10    | 0:03/ 0:00 | 73.57804489135742 |
+-------+-------+------------+------------+-------------------+
+----------------+-------+-----+-------+-------+-------+-------+
|      Type      |  MiP  | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-----+-------+-------+-------+-------+
|    article     |  0.0  | 0.0 |  0.0  | 0.922 | 0.922 | 0.922 |
| article_source | 0.435 | 1.0 | 0.606 | 0.905 | 0.952 | 0.92  |
|   accusation   | 0.056 | 0.1 | 0.071 | 0.94  | 0.946 | 0.941 |
+----------------+-------+-----+-------+-------+-------+-------+

2022-09-01 03:46:57,021 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   1   | train |    1/20    | 0:00/ 0:16 | 70.42029571533203 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-------+-----+-----+-------+-------+-------+
|      Type      |  MiP  | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-------+-----+-----+-------+-------+-------+
|    article     |  0.0  | 0.0 | 0.0 | 0.989 | 0.989 | 0.989 |
| article_source | 0.333 | 1.0 | 0.5 | 0.905 | 0.905 | 0.905 |
|   accusation   |  0.0  | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-------+-----+-----+-------+-------+-------+

2022-09-01 03:47:13,124 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   1   | train |   20/20    | 0:16/ 0:00 | 41.96110801696777 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     |  0.0  | 0.0  |  0.0  | 0.911 | 0.911 | 0.911 |
| article_source | 0.731 | 0.95 | 0.826 | 0.902 | 0.905 | 0.904 |
|   accusation   | 0.667 | 0.1  | 0.174 | 0.95  | 0.947 | 0.948 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 03:48:06,231 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | valid |    1/10    | 0:00/ 0:04 | 24.701812744140625 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.989 | 0.989 | 0.989 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:48:09,560 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | valid |   10/10    | 0:03/ 0:00 | 23.422783660888673 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.944 | 0.944 | 0.944 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:48:09,972 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | test  |    1/10    | 0:00/ 0:03 | 24.905536651611328 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.989 | 0.989 | 0.989 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:48:13,100 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | test  |   10/10    | 0:03/ 0:00 | 25.240122413635255 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.933 | 0.933 | 0.933 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:48:13,895 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |    1/20    | 0:00/ 0:14 | 22.717548370361328 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.989 | 0.989 | 0.989 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:48:29,443 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |   20/20    | 0:16/ 0:00 | 15.745910024642944 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     |  0.4  | 0.2  | 0.267 | 0.916 | 0.916 | 0.916 |
| article_source | 0.95  | 0.95 | 0.95  | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.526 | 0.5  | 0.513 | 0.95  | 0.953 | 0.951 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 03:49:06,413 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |    1/10    | 0:00/ 0:05 | 15.030704498291016 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:49:09,704 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |   10/10    | 0:03/ 0:00 | 13.310322761535645 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:49:10,093 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | test  |    1/10    | 0:00/ 0:03 | 14.566844940185547 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:49:13,076 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | test  |   10/10    | 0:03/ 0:00 | 16.255957412719727 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:49:13,944 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   3   | train |    1/20    | 0:00/ 0:15 | 11.988746643066406 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:49:29,395 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   3   | train |   20/20    | 0:16/ 0:00 | 9.653643941879272 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+------+------+------+-------+-------+-------+
|      Type      | MiP  | MiR  | MiF  |  MaP  |  MaR  |  MiF  |
+----------------+------+------+------+-------+-------+-------+
|    article     | 0.5  | 0.5  | 0.5  | 0.917 | 0.922 | 0.919 |
| article_source | 0.95 | 0.95 | 0.95 | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.5  | 0.5  | 0.5  | 0.949 | 0.953 | 0.95  |
+----------------+------+------+------+-------+-------+-------+

2022-09-01 03:50:14,617 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | valid |    1/10    | 0:00/ 0:05 | 12.85078239440918 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:50:17,924 - utils - INFO - 
+-------+-------+------------+------------+------------------+
| epoch | stage | iterations |    time    |       loss       |
+-------+-------+------------+------------+------------------+
|   3   | valid |   10/10    | 0:03/ 0:00 | 11.1126558303833 |
+-------+-------+------------+------------+------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:50:18,326 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:03 | 11.918386459350586 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:50:21,579 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 14.714321899414063 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:50:19,120 - legal_judgment_prediction.train - INFO - Train model successfully.
2022-09-01 03:54:29,378 - root - INFO - 



.\main.py -c .\configs\main\none\one_label\config.ini -m eval -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\none\one_label\checkpoint_3.pkl -bs 1
2022-09-01 03:54:29,378 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 03:54:30,207 - utils - INFO - CUDA is available.
2022-09-01 03:54:30,241 - utils - INFO - Initialize GPUs successfully.
2022-09-01 03:54:30,241 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 03:54:30,242 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 03:54:30,243 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 03:54:40,971 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 03:54:41,314 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 03:54:41,317 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 03:54:44,070 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 03:54:44,206 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 03:54:44,581 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 03:54:44,581 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 03:54:44,581 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 03:54:44,582 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 03:54:44,582 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 03:54:45,387 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:07 | 11.918386459350586 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:45,751 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    2/10    | 0:01/ 0:04 | 15.720158576965332 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.967 | 0.967 | 0.967 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:46,142 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    3/10    | 0:01/ 0:03 | 15.28972085316976 |
+-------+-------+------------+------------+-------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.956 | 0.956 | 0.956 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.973 | 0.973 | 0.973 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 03:54:46,495 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    4/10    | 0:01/ 0:02 | 16.352032899856567 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:46,825 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    5/10    | 0:02/ 0:02 | 16.983880043029785 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.4 | 0.4 | 0.4 | 0.924 | 0.952 | 0.932 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:47,162 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    6/10    | 0:02/ 0:01 | 16.17564884821574 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.944 | 0.944 | 0.944 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.966 | 0.966 | 0.966 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:47,508 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    7/10    | 0:02/ 0:01 | 15.823064395359584 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.933 | 0.933 | 0.933 |
| article_source | 0.571 | 0.571 | 0.571 | 0.932 | 0.952 | 0.939 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.959 | 0.959 | 0.959 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 03:54:47,843 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    8/10    | 0:03/ 0:00 | 14.464893460273743 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.125 | 0.125 | 0.125 | 0.935 | 0.944 | 0.936 |
| article_source | 0.625 | 0.625 | 0.625 | 0.935 | 0.952 | 0.941 |
|   accusation   | 0.125 | 0.125 | 0.125 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 03:54:48,180 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    9/10    | 0:03/ 0:00 | 14.180768330891928 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.111 | 0.111 | 0.111 | 0.935 | 0.944 | 0.936 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   | 0.111 | 0.111 | 0.111 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 03:54:48,501 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 14.714321899414063 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:54:48,502 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 14.714321899414063 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 03:59:57,856 - root - INFO - 



.\main.py -c .\configs\main\none\one_label\config.ini -m serve -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\none\one_label\checkpoint_3.pkl
2022-09-01 03:59:57,856 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 03:59:57,875 - utils - INFO - CUDA is available.
2022-09-01 03:59:57,876 - utils - INFO - Initialize GPUs successfully.
2022-09-01 03:59:57,876 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 03:59:57,877 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 03:59:57,878 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 03:59:59,896 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:00:00,238 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:00:00,242 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:00:02,957 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:00:02,979 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:00:03,004 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:00:03,006 - legal_judgment_prediction.serve.serve - INFO - Start to serve.
2022-09-01 04:00:11,427 - legal_judgment_prediction.serve.serve - INFO - The input fact: 一、陈叶丽香于民国107年5月10日15时10分许，驾驶车牌号码0000-○○号自小客车，沿台南市北区开元路由东向西行驶，行经该路与开元路63巷之之交岔路口欲右转时，原应注意转弯车应让直行车先行，且依当时情形应无不能注意之情事，却疏未注意，适有陈吉兴骑乘车牌号码○○○-000号普通重型机车，沿开元路由东向西骑乘于陈叶丽香所驾驶之自用小客车右方，陈叶丽香因有上述疏失，乃擦撞陈吉兴之机车，致陈吉兴人车倒地，并受有右侧肩膀擦伤、右侧手肘擦伤、右侧膝部擦伤、右侧大脚趾挫伤及指甲损伤等之伤害。二、案经陈吉兴诉由台南市政府警察局第五分局移送侦办。
2022-09-01 04:00:12,227 - legal_judgment_prediction.serve.serve - INFO - The prediction results: 可能觸犯的法條: 刑法第185条之3
可能觸犯的法源: 刑法
可能觸犯的罪名: 不能安全驾驶

2022-09-01 04:00:24,915 - legal_judgment_prediction.serve.serve - INFO - The input fact: shutdown
2022-09-01 04:00:24,915 - legal_judgment_prediction.serve.serve - INFO - Stop to serve.
2022-09-01 04:08:37,750 - root - INFO - 



.\main.py -c .\configs\main\bart\one_label\config.ini -m train -g 0 -bs 1 -dt
2022-09-01 04:08:37,750 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:08:38,573 - utils - INFO - CUDA is available.
2022-09-01 04:08:38,573 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:08:38,574 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:08:38,574 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:08:38,575 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:08:40,021 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:08:40,234 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:08:40,236 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:08:40,237 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2022-09-01 04:08:40,237 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2022-09-01 04:08:40,238 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2022-09-01 04:08:40,239 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2022-09-01 04:08:40,239 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2022-09-01 04:08:40,292 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:08:40,385 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:08:40,386 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2022-09-01 04:08:40,386 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2022-09-01 04:08:40,462 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:08:40,479 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:08:40,479 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2022-09-01 04:08:40,480 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 04:08:40,547 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:08:40,564 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:08:40,564 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 04:08:40,565 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 04:08:40,565 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 04:08:40,566 - legal_judgment_prediction.initialize - WARNING - The path of output results/checkpoints/legal_judgment_prediction/bert/bart/one_label does not exist.
2022-09-01 04:08:40,566 - legal_judgment_prediction.initialize - INFO - Make the directory automatically.
2022-09-01 04:08:40,748 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:08:40,748 - legal_judgment_prediction.train - INFO - Start to train model.
2022-09-01 04:08:43,291 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   0   | train |    1/20    | 0:02/ 0:48 | 188.16314697265625 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+-----+-------+-------+-------+-------+
|      Type      |  MiP  | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-----+-------+-------+-------+-------+
|    article     | 0.02  | 1.0 | 0.04  | 0.467 | 0.467 | 0.467 |
| article_source |  0.1  | 1.0 | 0.182 | 0.571 | 0.571 | 0.571 |
|   accusation   | 0.016 | 1.0 | 0.031 | 0.574 | 0.574 | 0.574 |
+----------------+-------+-----+-------+-------+-------+-------+

2022-09-01 04:08:58,543 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   0   | train |   20/20    | 0:17/ 0:00 | 119.91628723144531 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     | 0.008 | 0.15 | 0.014 | 0.171 | 0.182 | 0.172 |
| article_source | 0.317 | 0.95 | 0.475 | 0.236 | 0.238 | 0.237 |
|   accusation   | 0.006 | 0.15 | 0.012 | 0.24  | 0.247 | 0.24  |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:09:42,163 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |    1/10    | 0:00/ 0:04 | 58.02827835083008 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:09:45,629 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |   10/10    | 0:04/ 0:00 | 58.64981803894043 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.933 | 0.933 | 0.933 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.953 | 0.953 | 0.953 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:09:46,102 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   0   | test  |    1/10    | 0:00/ 0:03 | 56.997901916503906 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:09:49,442 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   0   | test  |   10/10    | 0:03/ 0:00 | 59.833466339111325 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.922 | 0.922 | 0.922 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.959 | 0.959 | 0.959 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:09:50,250 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   1   | train |    1/20    | 0:00/ 0:14 | 59.013702392578125 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.989 | 0.989 | 0.989 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:10:06,851 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   1   | train |   20/20    | 0:17/ 0:00 | 34.54649705886841 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+------+------+------+-------+-------+-------+
|      Type      | MiP  | MiR  | MiF  |  MaP  |  MaR  |  MiF  |
+----------------+------+------+------+-------+-------+-------+
|    article     | 0.0  | 0.0  | 0.0  | 0.911 | 0.911 | 0.911 |
| article_source | 0.95 | 0.95 | 0.95 | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.0  | 0.0  | 0.0  | 0.946 | 0.946 | 0.946 |
+----------------+------+------+------+-------+-------+-------+

2022-09-01 04:11:10,547 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   1   | valid |    1/10    | 0:00/ 0:06 | 20.53532600402832 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:11:14,012 - utils - INFO - 
+-------+-------+------------+------------+-----------------+
| epoch | stage | iterations |    time    |      loss       |
+-------+-------+------------+------------+-----------------+
|   1   | valid |   10/10    | 0:04/ 0:00 | 20.046337890625 |
+-------+-------+------------+------------+-----------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.953 | 0.953 | 0.953 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:11:14,423 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | test  |    1/10    | 0:00/ 0:03 | 19.437877655029297 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:11:17,899 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | test  |   10/10    | 0:03/ 0:00 | 22.924990272521974 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.959 | 0.959 | 0.959 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:11:18,693 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |    1/20    | 0:00/ 0:14 | 28.411048889160156 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 0.0 | 0.0 | 0.0 | 0.905 | 0.905 | 0.905 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:11:35,180 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |   20/20    | 0:17/ 0:00 | 13.541872835159301 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     | 0.167 | 0.05 | 0.077 | 0.913 | 0.912 | 0.912 |
| article_source | 0.95  | 0.95 | 0.95  | 0.95  | 0.952 | 0.951 |
|   accusation   |  0.0  | 0.0  |  0.0  | 0.946 | 0.946 | 0.946 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:12:03,088 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |    1/10    | 0:00/ 0:04 | 13.799446105957031 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:12:06,556 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |   10/10    | 0:03/ 0:00 | 12.685502862930297 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:12:06,975 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | test  |    1/10    | 0:00/ 0:03 | 12.517690658569336 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:12:10,669 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | test  |   10/10    | 0:04/ 0:00 | 16.062045764923095 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:12:11,546 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   3   | train |    1/20    | 0:00/ 0:15 | 7.421632766723633 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.993 | 0.993 | 0.993 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:12:28,569 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   3   | train |   20/20    | 0:17/ 0:00 | 9.094314074516296 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     |  0.5  | 0.5  |  0.5  | 0.917 | 0.922 | 0.919 |
| article_source | 0.95  | 0.95 | 0.95  | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.474 | 0.45 | 0.462 | 0.949 | 0.952 | 0.95  |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:12:57,649 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | valid |    1/10    | 0:00/ 0:04 | 12.712472915649414 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:01,795 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | valid |   10/10    | 0:04/ 0:00 | 11.185906648635864 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:02,246 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:03 | 11.328069686889648 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:05,771 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 15.375519275665283 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:05,833 - legal_judgment_prediction.train - INFO - Train model successfully.
2022-09-01 04:13:41,792 - root - INFO - 



.\main.py -c .\configs\main\bart\one_label\config.ini -m eval -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\bart\one_label\checkpoint_3.pkl -bs 1
2022-09-01 04:13:41,792 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:13:42,638 - utils - INFO - CUDA is available.
2022-09-01 04:13:42,639 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:13:42,639 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:13:42,639 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:13:42,640 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:13:45,976 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:13:46,185 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:13:46,188 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:13:48,436 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 04:13:48,437 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:13:48,458 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:13:48,459 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 04:13:48,459 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 04:13:48,459 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 04:13:48,462 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:13:49,392 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:08 | 11.328069686889648 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:49,764 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    2/10    | 0:01/ 0:05 | 16.72332763671875 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.967 | 0.967 | 0.967 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:50,118 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    3/10    | 0:01/ 0:03 | 15.707273483276367 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.956 | 0.956 | 0.956 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.973 | 0.973 | 0.973 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:13:50,479 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    4/10    | 0:02/ 0:03 | 17.30946969985962 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:50,850 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    5/10    | 0:02/ 0:02 | 18.271374130249022 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.4 | 0.4 | 0.4 | 0.924 | 0.952 | 0.932 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:51,218 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    6/10    | 0:02/ 0:01 | 17.15116596221924 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.944 | 0.944 | 0.944 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.966 | 0.966 | 0.966 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:51,592 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    7/10    | 0:03/ 0:01 | 16.522064481462753 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.933 | 0.933 | 0.933 |
| article_source | 0.571 | 0.571 | 0.571 | 0.932 | 0.952 | 0.939 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.959 | 0.959 | 0.959 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:13:51,942 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    8/10    | 0:03/ 0:00 | 15.038864731788635 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.125 | 0.125 | 0.125 | 0.935 | 0.944 | 0.936 |
| article_source | 0.625 | 0.625 | 0.625 | 0.935 | 0.952 | 0.941 |
|   accusation   | 0.125 | 0.125 | 0.125 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:13:52,303 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    9/10    | 0:03/ 0:00 | 14.626547389560276 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.111 | 0.111 | 0.111 | 0.935 | 0.944 | 0.936 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   | 0.111 | 0.111 | 0.111 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:13:52,667 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:04/ 0:00 | 15.375519275665283 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:13:52,669 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:04/ 0:00 | 15.375519275665283 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:14:10,577 - root - INFO - 



.\main.py -c .\configs\main\bart\one_label\config.ini -m serve -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\bart\one_label\checkpoint_3.pkl
2022-09-01 04:14:10,578 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:14:11,394 - utils - INFO - CUDA is available.
2022-09-01 04:14:11,394 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:14:11,395 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:14:11,395 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:14:11,396 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:14:13,452 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:14:13,708 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:14:13,712 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:14:16,370 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:14:16,395 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:14:16,433 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:14:16,436 - legal_judgment_prediction.serve.serve - INFO - Start to serve.
2022-09-01 04:14:36,316 - legal_judgment_prediction.serve.serve - INFO - The input fact: 台南市北区开元路一自用客车撞上机车，致1人受伤倒地，右侧大脚趾挫伤
2022-09-01 04:14:37,806 - legal_judgment_prediction.serve.serve - INFO - The prediction results: 可能觸犯的法條: 刑法第185条之3
可能觸犯的法源: 刑法
可能觸犯的罪名: 不能安全驾驶

2022-09-01 04:14:44,812 - legal_judgment_prediction.serve.serve - INFO - The input fact: shutdown
2022-09-01 04:14:44,812 - legal_judgment_prediction.serve.serve - INFO - Stop to serve.
2022-09-01 04:15:03,497 - root - INFO - 



.\main.py -c .\configs\main\lead_3\one_label\config.ini -m train -g 0 -bs 1 -dt
2022-09-01 04:15:03,498 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:15:04,385 - utils - INFO - CUDA is available.
2022-09-01 04:15:04,385 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:15:04,386 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:15:04,386 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:15:04,386 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:15:06,857 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:15:07,166 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:15:07,172 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:15:07,172 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2022-09-01 04:15:07,173 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2022-09-01 04:15:07,176 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2022-09-01 04:15:07,176 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2022-09-01 04:15:07,177 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2022-09-01 04:15:07,193 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:15:07,326 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:15:07,327 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2022-09-01 04:15:07,327 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2022-09-01 04:15:07,370 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:15:07,395 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:15:07,395 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2022-09-01 04:15:07,395 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 04:15:07,438 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:15:07,459 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:15:07,460 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 04:15:07,460 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 04:15:07,460 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 04:15:07,460 - legal_judgment_prediction.initialize - WARNING - The path of output results/checkpoints/legal_judgment_prediction/bert/lead_3/one_label does not exist.
2022-09-01 04:15:07,461 - legal_judgment_prediction.initialize - INFO - Make the directory automatically.
2022-09-01 04:15:07,462 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:15:07,462 - legal_judgment_prediction.train - INFO - Start to train model.
2022-09-01 04:15:10,658 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   0   | train |    1/20    | 0:03/ 1:00 | 197.8036346435547 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+-------+-----+-------+-------+-------+-------+
|      Type      |  MiP  | MiR |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-----+-------+-------+-------+-------+
|    article     | 0.02  | 1.0 | 0.04  | 0.467 | 0.467 | 0.467 |
| article_source | 0.071 | 1.0 | 0.133 | 0.381 | 0.381 | 0.381 |
|   accusation   |  0.0  | 0.0 |  0.0  | 0.514 | 0.514 | 0.514 |
+----------------+-------+-----+-------+-------+-------+-------+

2022-09-01 04:15:27,824 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   0   | train |   20/20    | 0:20/ 0:00 | 120.64849662780762 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     | 0.032 | 0.5  | 0.06  | 0.238 | 0.257 | 0.243 |
| article_source | 0.194 | 0.95 | 0.322 | 0.188 | 0.19  | 0.189 |
|   accusation   | 0.01  | 0.25 | 0.019 | 0.215 | 0.227 | 0.216 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:15:49,570 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |    1/10    | 0:00/ 0:04 | 60.57538604736328 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:15:52,885 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   0   | valid |   10/10    | 0:03/ 0:00 | 59.88757133483887 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.946 | 0.946 | 0.946 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:15:53,260 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   0   | test  |    1/10    | 0:00/ 0:02 | 61.356746673583984 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:15:56,740 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   0   | test  |   10/10    | 0:03/ 0:00 | 62.016029357910156 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.953 | 0.953 | 0.953 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:15:57,659 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   1   | train |    1/20    | 0:00/ 0:16 | 58.985862731933594 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:16:14,246 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   1   | train |   20/20    | 0:17/ 0:00 | 35.787909507751465 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     | 0.571 | 0.4  | 0.471 | 0.917 | 0.92  | 0.919 |
| article_source | 0.95  | 0.95 | 0.95  | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.263 | 0.25 | 0.256 | 0.942 | 0.943 | 0.942 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:16:39,228 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | valid |    1/10    | 0:00/ 0:04 | 22.257755279541016 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:16:42,504 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | valid |   10/10    | 0:03/ 0:00 | 20.556702613830566 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:16:42,944 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   1   | test  |    1/10    | 0:00/ 0:03 | 22.317363739013672 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:16:46,553 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   1   | test  |   10/10    | 0:03/ 0:00 | 23.42537212371826 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:16:47,427 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |    1/20    | 0:00/ 0:15 | 16.999427795410156 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-----+-----+-----+
|      Type      | MiP | MiR | MiF | MaP | MaR | MiF |
+----------------+-----+-----+-----+-----+-----+-----+
|    article     | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
| article_source | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
|   accusation   | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
+----------------+-----+-----+-----+-----+-----+-----+

2022-09-01 04:17:04,252 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   2   | train |   20/20    | 0:17/ 0:00 | 14.185240745544434 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-------+------+-------+-------+-------+-------+
|      Type      |  MiP  | MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+------+-------+-------+-------+-------+
|    article     |  0.5  | 0.2  | 0.286 | 0.917 | 0.916 | 0.916 |
| article_source | 0.95  | 0.95 | 0.95  | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.375 | 0.15 | 0.214 | 0.948 | 0.948 | 0.948 |
+----------------+-------+------+-------+-------+-------+-------+

2022-09-01 04:17:25,128 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |    1/10    | 0:00/ 0:03 | 15.018022537231445 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:17:28,455 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | valid |   10/10    | 0:03/ 0:00 | 12.996283054351807 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:17:28,871 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   2   | test  |    1/10    | 0:00/ 0:03 | 14.400785446166992 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:17:32,035 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   2   | test  |   10/10    | 0:03/ 0:00 | 16.79052801132202 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:17:32,907 - utils - INFO - 
+-------+-------+------------+------------+--------------------+---------------+
| epoch | stage | iterations |    time    |        loss        | learning_rate |
+-------+-------+------------+------------+--------------------+---------------+
|   3   | train |    1/20    | 0:00/ 0:15 | 11.223274230957031 |     1e-05     |
+-------+-------+------------+------------+--------------------+---------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:17:49,186 - utils - INFO - 
+-------+-------+------------+------------+-------------------+---------------+
| epoch | stage | iterations |    time    |       loss        | learning_rate |
+-------+-------+------------+------------+-------------------+---------------+
|   3   | train |   20/20    | 0:17/ 0:00 | 9.301921224594116 |     1e-05     |
+-------+-------+------------+------------+-------------------+---------------+
+----------------+------+------+------+-------+-------+-------+
|      Type      | MiP  | MiR  | MiF  |  MaP  |  MaR  |  MiF  |
+----------------+------+------+------+-------+-------+-------+
|    article     | 0.5  | 0.5  | 0.5  | 0.917 | 0.922 | 0.919 |
| article_source | 0.95 | 0.95 | 0.95 | 0.95  | 0.952 | 0.951 |
|   accusation   | 0.5  | 0.5  | 0.5  | 0.949 | 0.953 | 0.95  |
+----------------+------+------+------+-------+-------+-------+

2022-09-01 04:18:08,754 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | valid |    1/10    | 0:00/ 0:04 | 13.765998840332031 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:18:12,704 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | valid |   10/10    | 0:04/ 0:00 | 11.340006399154664 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.4 | 0.4 | 0.4 | 0.949 | 0.956 | 0.951 |
| article_source | 0.9 | 0.9 | 0.9 | 0.948 | 0.952 | 0.95  |
|   accusation   | 0.3 | 0.3 | 0.3 | 0.955 | 0.959 | 0.956 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:18:13,196 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:04 | 12.212640762329102 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:18:16,876 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:04/ 0:00 | 15.571859550476074 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:18:16,933 - legal_judgment_prediction.train - INFO - Train model successfully.
2022-09-01 04:20:37,417 - root - INFO - 



.\main.py -c .\configs\main\lead_3\one_label\config.ini -m eval -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\lead_3\one_label\checkpoint_3.pkl -bs 1
2022-09-01 04:20:37,417 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:20:38,257 - utils - INFO - CUDA is available.
2022-09-01 04:20:38,258 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:20:38,258 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:20:38,258 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:20:38,259 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:20:45,298 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:20:45,540 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:20:45,545 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:20:48,216 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize test dataloader.
2022-09-01 04:20:48,217 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:20:48,582 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:20:48,582 - legal_judgment_prediction.dataset.initialize - INFO - Initialize test dataloader successfully.
2022-09-01 04:20:48,582 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2022-09-01 04:20:48,583 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2022-09-01 04:20:48,583 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:20:49,464 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    1/10    | 0:00/ 0:07 | 12.212640762329102 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.978 | 0.978 | 0.978 |
| article_source | 1.0 | 1.0 | 1.0 |  1.0  |  1.0  |  1.0  |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.986 | 0.986 | 0.986 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:49,834 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    2/10    | 0:01/ 0:04 | 16.79612445831299 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.967 | 0.967 | 0.967 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.98  | 0.98  | 0.98  |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:50,217 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    3/10    | 0:01/ 0:03 | 16.469606399536133 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.956 | 0.956 | 0.956 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.973 | 0.973 | 0.973 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:20:50,560 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    4/10    | 0:01/ 0:02 | 17.697206497192383 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:50,883 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    5/10    | 0:02/ 0:02 | 18.433448028564452 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.956 | 0.956 | 0.956 |
| article_source | 0.4 | 0.4 | 0.4 | 0.924 | 0.952 | 0.932 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.973 | 0.973 | 0.973 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:51,200 - utils - INFO - 
+-------+-------+------------+------------+-------------------+
| epoch | stage | iterations |    time    |       loss        |
+-------+-------+------------+------------+-------------------+
|   3   | test  |    6/10    | 0:02/ 0:01 | 17.41966978708903 |
+-------+-------+------------+------------+-------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.0 | 0.0 | 0.0 | 0.944 | 0.944 | 0.944 |
| article_source | 0.5 | 0.5 | 0.5 | 0.929 | 0.952 | 0.937 |
|   accusation   | 0.0 | 0.0 | 0.0 | 0.966 | 0.966 | 0.966 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:51,511 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    7/10    | 0:02/ 0:01 | 16.823945454188756 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     |  0.0  |  0.0  |  0.0  | 0.933 | 0.933 | 0.933 |
| article_source | 0.571 | 0.571 | 0.571 | 0.932 | 0.952 | 0.939 |
|   accusation   |  0.0  |  0.0  |  0.0  | 0.959 | 0.959 | 0.959 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:20:51,838 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    8/10    | 0:03/ 0:00 | 15.265769004821777 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.125 | 0.125 | 0.125 | 0.935 | 0.944 | 0.936 |
| article_source | 0.625 | 0.625 | 0.625 | 0.935 | 0.952 | 0.941 |
|   accusation   | 0.125 | 0.125 | 0.125 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:20:52,185 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |    9/10    | 0:03/ 0:00 | 14.926581700642904 |
+-------+-------+------------+------------+--------------------+
+----------------+-------+-------+-------+-------+-------+-------+
|      Type      |  MiP  |  MiR  |  MiF  |  MaP  |  MaR  |  MiF  |
+----------------+-------+-------+-------+-------+-------+-------+
|    article     | 0.111 | 0.111 | 0.111 | 0.935 | 0.944 | 0.936 |
| article_source | 0.667 | 0.667 | 0.667 | 0.937 | 0.952 | 0.943 |
|   accusation   | 0.111 | 0.111 | 0.111 | 0.96  | 0.966 | 0.961 |
+----------------+-------+-------+-------+-------+-------+-------+

2022-09-01 04:20:52,528 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 15.571859550476074 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:20:52,530 - utils - INFO - 
+-------+-------+------------+------------+--------------------+
| epoch | stage | iterations |    time    |        loss        |
+-------+-------+------------+------------+--------------------+
|   3   | test  |   10/10    | 0:03/ 0:00 | 15.571859550476074 |
+-------+-------+------------+------------+--------------------+
+----------------+-----+-----+-----+-------+-------+-------+
|      Type      | MiP | MiR | MiF |  MaP  |  MaR  |  MiF  |
+----------------+-----+-----+-----+-------+-------+-------+
|    article     | 0.1 | 0.1 | 0.1 | 0.934 | 0.944 | 0.935 |
| article_source | 0.6 | 0.6 | 0.6 | 0.933 | 0.952 | 0.94  |
|   accusation   | 0.1 | 0.1 | 0.1 | 0.96  | 0.966 | 0.961 |
+----------------+-----+-----+-----+-------+-------+-------+

2022-09-01 04:21:17,022 - root - INFO - 



.\main.py -c .\configs\main\lead_3\one_label\config.ini -m serve -g 0 -cp .\results\checkpoints\legal_judgment_prediction\bert\lead_3\one_label\checkpoint_3.pkl
2022-09-01 04:21:17,022 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2022-09-01 04:21:17,843 - utils - INFO - CUDA is available.
2022-09-01 04:21:17,843 - utils - INFO - Initialize GPUs successfully.
2022-09-01 04:21:17,844 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2022-09-01 04:21:17,844 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2022-09-01 04:21:17,844 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2022-09-01 04:21:19,302 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2022-09-01 04:21:19,496 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2022-09-01 04:21:19,498 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2022-09-01 04:21:21,570 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2022-09-01 04:21:21,590 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2022-09-01 04:21:21,608 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2022-09-01 04:21:21,611 - legal_judgment_prediction.serve.serve - INFO - Start to serve.
2022-09-01 04:21:24,819 - legal_judgment_prediction.serve.serve - INFO - The input fact: 一、陈叶丽香于民国107年5月10日15时10分许，驾驶车牌号码0000-○○号自小客车，沿台南市北区开元路由东向西行驶。
2022-09-01 04:21:28,341 - legal_judgment_prediction.serve.serve - INFO - The prediction results: 可能觸犯的法條: 刑法第185条之3
可能觸犯的法源: 刑法
可能觸犯的罪名: 不能安全驾驶

2022-09-01 04:21:32,034 - legal_judgment_prediction.serve.serve - INFO - The input fact: shutdown
2022-09-01 04:21:32,034 - legal_judgment_prediction.serve.serve - INFO - Stop to serve.
2023-01-08 15:15:00,150 - root - INFO - 



main.py -c configs/main/bart/one_label/config.ini -m train -g 0 -bs 1
2023-01-08 15:15:00,150 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2023-01-08 15:15:00,154 - utils - INFO - CUDA is available.
2023-01-08 15:15:00,155 - utils - INFO - Initialize GPUs successfully.
2023-01-08 15:15:00,155 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2023-01-08 15:15:00,155 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2023-01-08 15:15:00,155 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2023-01-08 15:15:02,074 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2023-01-08 15:15:03,489 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2023-01-08 15:15:03,491 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2023-01-08 15:15:03,491 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2023-01-08 15:15:03,491 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2023-01-08 15:15:03,492 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2023-01-08 15:15:03,492 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2023-01-08 15:15:03,492 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2023-01-08 15:15:06,792 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:15:06,808 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:15:06,808 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2023-01-08 15:15:06,808 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2023-01-08 15:15:07,805 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:15:07,820 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:15:07,821 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2023-01-08 15:15:07,821 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2023-01-08 15:15:07,821 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2023-01-08 15:15:07,822 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2023-01-08 15:15:07,822 - legal_judgment_prediction.train - INFO - Start to train model.
2023-01-08 15:15:34,989 - root - INFO - 



main.py -c configs/main/bart/one_label/config.ini -m train -g 0 -bs 1
2023-01-08 15:15:34,989 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2023-01-08 15:15:34,993 - utils - INFO - CUDA is available.
2023-01-08 15:15:34,993 - utils - INFO - Initialize GPUs successfully.
2023-01-08 15:15:34,993 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2023-01-08 15:15:34,994 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2023-01-08 15:15:34,994 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2023-01-08 15:15:36,552 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2023-01-08 15:15:37,954 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2023-01-08 15:15:37,956 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2023-01-08 15:15:37,956 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2023-01-08 15:15:37,956 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2023-01-08 15:15:37,957 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2023-01-08 15:15:37,957 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2023-01-08 15:15:37,957 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2023-01-08 15:15:41,274 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:15:41,291 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:15:41,291 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2023-01-08 15:15:41,292 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2023-01-08 15:15:42,286 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:15:42,307 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:15:42,307 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2023-01-08 15:15:42,307 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2023-01-08 15:15:42,307 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2023-01-08 15:15:42,308 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2023-01-08 15:15:42,308 - legal_judgment_prediction.train - INFO - Start to train model.
2023-01-08 15:16:17,548 - root - INFO - 



main.py -c configs/main/bart/one_label/config.ini -m train -g 0 -bs 1
2023-01-08 15:16:17,548 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2023-01-08 15:16:17,552 - utils - INFO - CUDA is available.
2023-01-08 15:16:17,552 - utils - INFO - Initialize GPUs successfully.
2023-01-08 15:16:17,553 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2023-01-08 15:16:17,553 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2023-01-08 15:16:17,553 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

2023-01-08 15:16:19,278 - legal_judgment_prediction.model.initialize - INFO - Initialize model successfully.
2023-01-08 15:16:20,779 - legal_judgment_prediction.initialize - INFO - Start to initialize multiple gpus.
2023-01-08 15:16:20,781 - legal_judgment_prediction.initialize - INFO - Initialize multiple gpus successfully.
2023-01-08 15:16:20,781 - legal_judgment_prediction.model.initialize - INFO - Start to initialize optimizer.
2023-01-08 15:16:20,782 - pytorch_pretrained_bert.optimization - WARNING - t_total value of -1 results in schedule not being applied
2023-01-08 15:16:20,782 - legal_judgment_prediction.model.initialize - INFO - Initialize optimizer successfully.
2023-01-08 15:16:20,783 - legal_judgment_prediction.initialize - WARNING - The path of checkpoint is none.
2023-01-08 15:16:20,783 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize train dataloader.
2023-01-08 15:16:24,080 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:16:24,095 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:16:24,096 - legal_judgment_prediction.dataset.initialize - INFO - Initialize train dataloader successfully.
2023-01-08 15:16:24,096 - legal_judgment_prediction.dataset.initialize - INFO - Start to initialize valid dataloader.
2023-01-08 15:16:25,112 - legal_judgment_prediction.formatter.initialize - INFO - Start to initialize formatter.
2023-01-08 15:16:25,127 - legal_judgment_prediction.formatter.initialize - INFO - Initialize formatter successfully.
2023-01-08 15:16:25,127 - legal_judgment_prediction.dataset.initialize - INFO - Initialize valid dataloader successfully.
2023-01-08 15:16:25,127 - legal_judgment_prediction.output.initialize - INFO - Start to initialize output function.
2023-01-08 15:16:25,127 - legal_judgment_prediction.output.initialize - INFO - Initialize output function successfully.
2023-01-08 15:16:25,128 - legal_judgment_prediction.initialize - INFO - Initialize successfully.
2023-01-08 15:16:25,128 - legal_judgment_prediction.train - INFO - Start to train model.
2023-01-08 15:42:37,092 - root - INFO - 



main.py -c configs/main/bart/one_label/config.ini -m train -g 0 -bs 1
2023-01-08 15:42:37,092 - legal_judgment_prediction.initialize - INFO - Start to initialize.
2023-01-08 15:42:37,097 - utils - INFO - CUDA is available.
2023-01-08 15:42:37,097 - utils - INFO - Initialize GPUs successfully.
2023-01-08 15:42:37,097 - legal_judgment_prediction.model.initialize - INFO - Start to initialize model.
2023-01-08 15:42:37,097 - pytorch_pretrained_bert.modeling - INFO - loading archive file models/bert-base-chinese
2023-01-08 15:42:37,097 - pytorch_pretrained_bert.modeling - INFO - Model config {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 21128
}

